<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lvluplife — Drömlik vit transition</title>
  <link rel="stylesheet" href="styles.css">
  <!-- Fallback font-family i CSS används; inga externa resurser -->
  <meta name="description" content="Demo: drömlik vit transition med veil + wash. Klicka på knappen för att spela animationen.">
  <style>
    /* Små extra-responsiva tweaks som kompletterar din styles.css */
    @media (max-width: 480px){
      :root{
        --divider-width: 72vw;
        --btn-pad-x: 28px;
        --btn-pad-y: 14px;
        --title-bottom-gap: 12px;
        --subtext-bottom-gap: 20px;
      }
      body{ padding-top:10vh; }
      h1{ font-size: clamp(1.8rem, 10vw, 3.4rem); }
    }

    /* Gör divider mer responsiv på mellan-storlek */
    @media (min-width: 480px) and (max-width: 920px){
      :root{ --divider-width: min(420px, 76vw); }
    }

    /* säkerställ att overlay är synligt för skärmläsare (men inte pointer-events) */
    .dream-overlay[aria-hidden="false"]{ pointer-events:none; }
  </style>
</head>
<body>
  <main>
    <!-- Huvudrubrik -->
    <h1 id="page-title">Lvluplife</h1>

    <!-- Divider -->
    <div class="divider" role="separator" aria-hidden="true"></div>

    <!-- Subtext (placerad mellan strecket och knappen enligt önskan) -->
    <p class="subtext" id="subtext">Drömsk, vit övergång — klicka för att uppleva effekten.</p>

    <!-- Startknapp -->
    <button class="start-btn" id="startBtn" aria-describedby="hint" type="button">
      Start
    </button>

    <!-- Hint -->
    <p class="hint" id="hint">Tryck på mellanslag eller Enter när knappen är fokuserad.</p>
  </main>

  <!-- Dream overlay (initialt tom, fylls av JS när knappen trycks) -->
  <div class="dream-overlay" id="dreamOverlay" aria-hidden="true"></div>

  <script>
    // Enkel JS som triggar overlay-animationen och tar bort den när den är klar.
    (function(){
      const btn = document.getElementById('startBtn');
      const overlay = document.getElementById('dreamOverlay');

      // Hjälpfunktion: läs --dream-total-ms från :root (i CSS)
      function getDreamMs(){
        const root = getComputedStyle(document.documentElement);
        const val = root.getPropertyValue('--dream-total-ms').trim();
        // osäkert värde? fallback 2600
        const ms = parseInt(val, 10);
        return Number.isFinite(ms) ? ms : 2600;
      }

      // Skapa overlay-elementen och lägg till dem i DOM
      function playDream(){
        // Om animation redan pågår, ignore
        if (overlay.dataset.playing === 'true') return;

        const totalMs = getDreamMs();
        overlay.dataset.playing = 'true';
        overlay.setAttribute('aria-hidden','false');

        // Skapa veil + wash (CSS-animering körs när elementen läggs till)
        overlay.innerHTML = '<div class="veil" role="presentation"></div><div class="wash" role="presentation"></div>';

        // Ta bort animationselementen efter total tid + liten buffer
        setTimeout(() => {
          overlay.innerHTML = '';
          overlay.dataset.playing = 'false';
          overlay.setAttribute('aria-hidden','true');
        }, totalMs + 150); // buffer 150ms
      }

      // Event listeners: klick + keyboard (mellanslag / enter)
      btn.addEventListener('click', playDream);
      btn.addEventListener('keydown', (e) => {
        if (e.key === ' ' || e.key === 'Spacebar' || e.key === 'Enter') {
          // Förhindra default scroll vid mellanslag när knappen har fokus
          e.preventDefault();
          playDream();
        }
      });

      // Optional: låt användaren trycka "r" för replay (om de vill)
      document.addEventListener('keydown', (e) => {
        if ((e.key === 'r' || e.key === 'R') && document.activeElement !== null) {
          // replay från vilken position som helst
          playDream();
        }
      });

      // Tillgänglighetsförbättring: fokus-styling synligt när man navigerar med keyboard
      // (detta sker via :focus-visible i din CSS redan)
    })();
  </script>
</body>
</html>
