<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lvluplife – Start (Dreamy Whisper)</title>

  <style>
    /* =========================================================
       (1) KONTROLLPANEL – ändra färger, tider & känsla här
       ========================================================= */
    :root{
      /* Bas */
      --bg: #0a0a0a;
      --fg: #ffffff;

      /* Rubrik + layout */
      --title-glow: rgba(0,255,200,.4);
      --title-size-min: 2.5rem;
      --title-size-fluid: 8vw;
      --title-size-max: 6rem;
      --title-bottom-gap: 18px;

      /* Streck */
      --accent: rgba(255,255,255,.35);
      --divider-width: 300px;
      --divider-height: 2px;
      --divider-opacity: .55;
      --divider-bottom-gap: 16px;

      /* Subtext */
      --subtext-size: 1rem;
      --subtext-opacity: .65;
      --subtext-letterspace: .05em;
      --subtext-bottom-gap: 28px;

      /* Knapp */
      --btn-text: #ffffff;
      --btn-grad-from: #00f0ff;
      --btn-grad-to:   #0077ff;
      --btn-radius: 12px;
      --btn-pad-y: 18px;
      --btn-pad-x: 52px;
      --btn-letterspace: 2px;
      --btn-fontsize: 1.2rem;
      --btn-shadow: 0 0 25px rgba(0,255,255,.35);

      /* Hint */
      --hint-size: .95rem;
      --hint-opacity: .6;
      --hint-top-gap: 16px;

      /* ============ DRÖMMIG PORTAL (på klick) ============ */
      /* Längder & timingar */
      --dream-total-ms: 1600;               /* total sekvenslängd (ms) */
      --show-delay-frac: 0.28;              /* när viskningstexten börjar (andel av total) */
      --hide-before-end-ms: 460;            /* börja tona ut text så många ms före slut */

      /* Dimtintar (varma, mjuka) */
      --mist1: rgba(255,255,250,0.85);
      --mist2: rgba(245,255,250,0.55);
      --mist3: rgba(255,245,255,0.32);

      /* Rörelse/easing */
      --mist-ease: cubic-bezier(.22,.55,.1,1); /* krämig easing */
      --mist-blur: 18px;                       /* grund-blur för dimman */

      /* Viskningstext */
      --whisper-text: "Do you have what it takes?";
      --whisper-size: clamp(18px, 3.2vw, 28px);
      --whisper-color: rgba(0,0,0,0.75);   /* låg kontrast mot ljus dimma */
      --whisper-weight: 600;
      --whisper-letter: .08em;
      --whisper-in-ms: 900;                /* långsamt in */
      --whisper-out-ms: 560;               /* mjukt ut */
      --whisper-char-translate: 8px;       /* hur långt varje bokstav glider */
      --char-stagger-min: 18;              /* ms, min */
      --char-stagger-max: 65;              /* ms, max */
      --whisper-breath-amp: .12;           /* “andning” i opacity (0–1) */
    }

    /* =========================================================
       (2) BASLAYOUT
       ========================================================= */
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%}
    body{
      background: var(--bg);
      color: var(--fg);
      font-family: "Poppins","Helvetica Neue",Arial,sans-serif;
      display:flex; flex-direction:column; align-items:center;
      justify-content:flex-start; overflow:hidden;
      padding-top: 12vh;
    }
    main{ width:min(920px,92vw); text-align:center; }

    /* =========================================================
       (3) RUBRIK + STRECK + SUBTEXT
       ========================================================= */
    h1{
      font-size: clamp(var(--title-size-min), var(--title-size-fluid), var(--title-size-max));
      font-weight: 800;
      letter-spacing: .08em;
      text-transform: uppercase;
      margin-bottom: var(--title-bottom-gap);
      text-shadow: 0 0 25px var(--title-glow);
    }
    .divider{
      width: var(--divider-width);
      height: var(--divider-height);
      background: var(--accent);
      margin: 0 auto var(--divider-bottom-gap) auto;
      border-radius: 1px;
      opacity: var(--divider-opacity);
    }
    .subtext{
      font-size: var(--subtext-size);
      opacity: var(--subtext-opacity);
      letter-spacing: var(--subtext-letterspace);
      margin-bottom: var(--subtext-bottom-gap);
    }

    /* =========================================================
       (4) KNAPP + HINT
       ========================================================= */
    .start-btn{
      display:inline-block;
      padding: var(--btn-pad-y) var(--btn-pad-x);
      color: var(--btn-text);
      background: linear-gradient(90deg, var(--btn-grad-from), var(--btn-grad-to));
      border: none;
      border-radius: var(--btn-radius);
      cursor: pointer;
      text-transform: uppercase;
      font-weight: 700;
      letter-spacing: var(--btn-letterspace);
      font-size: var(--btn-fontsize);
      box-shadow: var(--btn-shadow);
      transition: transform .25s ease, box-shadow .25s ease, filter .25s ease;
      text-decoration:none;
      z-index:2;
    }
    .start-btn:hover{ transform: scale(1.05); filter:saturate(1.05) }
    .start-btn:active{ transform: scale(.985) }
    .start-btn:focus-visible{
      outline: 2px solid rgba(0,255,200,.6);
      outline-offset: 3px;
    }
    .hint{
      margin-top: var(--hint-top-gap);
      font-size: var(--hint-size);
      opacity: var(--hint-opacity);
      letter-spacing: .05em;
    }

    /* =========================================================
       (5) DRÖMMIG OVERLAY + VISKNING
       ========================================================= */
    .dream-overlay{
      position: fixed; inset: 0; z-index: 9998; pointer-events: none;
      display: grid; place-items: center;
    }

    /* tre lager dimma för djup */
    .mist{
      position:absolute; inset: -15vh -15vw; /* större än viewport för skala/translation */
      filter: blur(var(--mist-blur));
      opacity: 0;
      transform: scale(.95);
      mix-blend-mode: screen; /* mjuk ljusning mot mörk bakgrund */
    }
    .mist-1{
      background:
        radial-gradient(60vmax 60vmax at 40% 45%, var(--mist1) 0%, transparent 60%),
        radial-gradient(40vmax 40vmax at 70% 60%, var(--mist2) 0%, transparent 70%);
      animation: mistRise var(--dream-total-ms)ms var(--mist-ease) forwards,
                 breathe calc(var(--dream-total-ms)*1ms) ease-in-out infinite;
    }
    .mist-2{
      background:
        radial-gradient(70vmax 70vmax at 60% 35%, var(--mist2) 0%, transparent 65%),
        radial-gradient(50vmax 50vmax at 30% 65%, var(--mist3) 0%, transparent 75%);
      animation: mistDrift var(--dream-total-ms)ms var(--mist-ease) forwards,
                 breatheSlow calc(var(--dream-total-ms)*1ms) ease-in-out infinite;
    }
    .mist-3{
      background:
        radial-gradient(55vmax 55vmax at 50% 50%, var(--mist1) 0%, transparent 60%);
      animation: mistPulse var(--dream-total-ms)ms var(--mist-ease) forwards,
                 breathe calc(var(--dream-total-ms)*1ms) ease-in-out infinite;
    }

    @keyframes mistRise{
      0%   { opacity: 0; transform: scale(.92) translateY(12px); }
      40%  { opacity: .85; transform: scale(1.01) translateY(0px); }
      100% { opacity: 0; transform: scale(1.05) translateY(-8px); }
    }
    @keyframes mistDrift{
      0%   { opacity: 0; transform: scale(.94) translateX(-10px); }
      35%  { opacity: .65; transform: scale(1.0) translateX(0); }
      100% { opacity: 0; transform: scale(1.06) translateX(10px); }
    }
    @keyframes mistPulse{
      0%   { opacity: 0; transform: scale(.9); }
      50%  { opacity: .55; transform: scale(1.02); }
      100% { opacity: 0; transform: scale(1.06); }
    }
    @keyframes breathe{
      0%,100% { filter: blur(var(--mist-blur)); }
      50%     { filter: blur(calc(var(--mist-blur) + 4px)); }
    }
    @keyframes breatheSlow{
      0%,100% { opacity: .9; }
      50%     { opacity: calc(.9 - var(--whisper-breath-amp)); }
    }

    /* viskningstext – låg kontrast, bokstavsvåg */
    .whisper{
      position: absolute; inset: 0; z-index: 9999;
      display: grid; place-items: center;
      pointer-events: none;
      opacity: 0;
      transition: opacity var(--whisper-in-ms)ms var(--mist-ease);
      padding: 0 16px; text-align: center;
      mix-blend-mode: multiply;
    }
    .whisper.show{ opacity: 1; }
    .whisper.hide{
      opacity: 0;
      transition: opacity var(--whisper-out-ms)ms var(--mist-ease);
    }
    .whisper .line{
      font: var(--whisper-weight) var(--whisper-size)/1.15 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
      letter-spacing: var(--whisper-letter);
      color: var(--whisper-color);
      white-space: pre-wrap;
    }
    .char{
      display:inline-block;
      opacity: 0;
      transform: translateY(var(--whisper-char-translate));
      filter: blur(2px);
      transition: opacity .6s var(--mist-ease), transform .6s var(--mist-ease), filter .6s var(--mist-ease);
    }
    .char.on{
      opacity: 1;
      transform: translateY(0);
      filter: blur(0px);
    }

    @media (prefers-reduced-motion: reduce){
      .mist, .whisper, .char{ animation: none !important; transition: none !important; }
    }
  </style>
</head>
<body>
  <main>
    <!-- RUBRIK + STRECK -->
    <h1>Lvluplife</h1>
    <div class="divider"></div>

    <!-- SUBTEXT -->
    <p class="subtext">This is a tool for the one who needs the extra HP</p>

    <!-- KNAPP -->
    <a id="startBtn" class="start-btn" href="journey.html" role="button">Start your journey</a>

    <!-- HINT -->
    <p class="hint">Do you have what it takes?</p>
  </main>

  <!-- DREAMY OVERLAY (skapas dynamiskt i JS vid klick) -->

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const NEXT_URL = 'journey.html';

      // Läs variabler från CSS
      const css = getComputedStyle(document.documentElement);
      const DREAM_TOTAL = +css.getPropertyValue('--dream-total-ms').trim() || 1600;
      const SHOW_DELAY_FRAC = +css.getPropertyValue('--show-delay-frac').trim() || 0.28;
      const HIDE_BEFORE_END = +css.getPropertyValue('--hide-before-end-ms').trim() || 460;

      const SHOW_DELAY_MS = Math.round(DREAM_TOTAL * SHOW_DELAY_FRAC);

      const startBtn = document.getElementById('startBtn');

      let clicked = false;
      let timers = [];

      function clearTimers(){
        timers.forEach(t => clearTimeout(t));
        timers = [];
      }

      function makeOverlay(){
        const wrap = document.createElement('div');
        wrap.className = 'dream-overlay';
        wrap.innerHTML = `
          <div class="mist mist-1"></div>
          <div class="mist mist-2"></div>
          <div class="mist mist-3"></div>
          <div class="whisper" aria-hidden="true"><div class="line"></div></div>
        `;
        document.body.appendChild(wrap);
        return wrap;
      }

      function splitWhisper(lineEl, text){
        lineEl.innerHTML = ''; // reset
        const frag = document.createDocumentFragment();
        for (const ch of text){
          const span = document.createElement('span');
          span.className = 'char';
          span.textContent = ch;
          frag.appendChild(span);
        }
        lineEl.appendChild(frag);
      }

      function setWhisperText(wrap){
        const whisper = wrap.querySelector('.whisper');
        const line = whisper.querySelector('.line');
        // hämta text från CSS-variabeln --whisper-text
        let t = getComputedStyle(document.documentElement).getPropertyValue('--whisper-text').trim();
        t = t.replace(/^["']|["']$/g,''); // ta bort citattecken
        if(!t) t = 'Do you have what it takes?';
        splitWhisper(line, t);
        return whisper;
      }

      function staggerChars(whisper){
        const chars = Array.from(whisper.querySelectorAll('.char'));
        if (!chars.length) return;

        // slumpa lätt inom ett intervall för att få organisk känsla
        const css = getComputedStyle(document.documentElement);
        const min = +css.getPropertyValue('--char-stagger-min').trim() || 18;
        const max = +css.getPropertyValue('--char-stagger-max').trim() || 65;

        let time = 0;
        chars.forEach((span, i) => {
          const jitter = Math.floor(min + Math.random() * (max - min));
          time += jitter;
          const t = setTimeout(() => span.classList.add('on'), time);
          timers.push(t);
        });
      }

      function enterDream(e){
        e.preventDefault();
        if (clicked) return;
        clicked = true;

        // skapa overlay
        const overlay = makeOverlay();
        const whisper = setWhisperText(overlay);

        // visa whisper senare (drömmigt)
        const showT = setTimeout(() => {
          whisper.classList.add('show');
          staggerChars(whisper);
        }, SHOW_DELAY_MS);
        timers.push(showT);

        // tona ut whisper innan slut
        const hideAt = Math.max(0, DREAM_TOTAL - HIDE_BEFORE_END);
        const hideT = setTimeout(() => whisper.classList.add('hide'), hideAt);
        timers.push(hideT);

        // navigera när sekvensen är klar
        const navT = setTimeout(() => { window.location.href = NEXT_URL; }, DREAM_TOTAL);
        timers.push(navT);

        // safety – rensa overlay några hundradelar efter
        const cleanupT = setTimeout(() => {
          overlay.remove();
          clearTimers();
        }, DREAM_TOTAL + 200);
        timers.push(cleanupT);
      }

      startBtn.addEventListener('click', enterDream);
      startBtn.addEventListener('keydown', (e)=>{
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); enterDream(e); }
      });

      window.addEventListener('pageshow', () => { clicked = false; clearTimers(); });

      function getComputedNumber(varName, fallback){
        const v = +css.getPropertyValue(varName).trim();
        return Number.isFinite(v) ? v : fallback;
      }
    });
  </script>
</body>
</html>
