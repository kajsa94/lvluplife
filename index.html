<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lvluplife – Start</title>

  <!-- Viktigt: din fil heter styles.css -->
  <link rel="stylesheet" href="styles.css?v=1">
</head>
<body>
  <main>
    <!-- RUBRIK + STRECK -->
    <h1>Lvluplife</h1>
    <div class="divider"></div>

    <!-- SUBTEXT -->
    <p class="subtext"></p>

    <!-- KNAPP -->
    <a id="startBtn" class="start-btn" href="next.html" role="button">Start your journey</a>

    <!-- HINT (valfri – kan tas bort) -->
    <p class="hint"></p>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const NEXT_URL = 'next.html'; // ✅ ändrat från journey.html till next.html

      // Läs tider från CSS-variabler
      const root = getComputedStyle(document.documentElement);
      const TOTAL = +(root.getPropertyValue('--dream-total-ms').trim() || 2600);

      const startBtn = document.getElementById('startBtn');
      let clicked = false;
      let timers = [];

      function t(fn, ms){ const id = setTimeout(fn, ms); timers.push(id); return id; }
      function clearAll(){ timers.forEach(clearTimeout); timers = []; }

      function makeOverlay(){
        const wrap = document.createElement('div');
        wrap.className = 'dream-overlay';
        // Endast ljus/sken – ingen text
        wrap.innerHTML = `
          <div class="veil"></div>
          <div class="wash"></div>
        `;
        document.body.appendChild(wrap);
        return wrap;
      }

      function enterDream(e){
        e.preventDefault();
        if (clicked) return;
        clicked = true;

        const overlay = makeOverlay();
        // Animationerna sker via CSS keyframes automatiskt

        // Navigera när sekvensen är klar
        t(() => { window.location.href = NEXT_URL; }, TOTAL);

        // Städa lite efteråt
        t(() => { overlay.remove(); clearAll(); }, TOTAL + 250);
      }

      startBtn.addEventListener('click', enterDream);
      startBtn.addEventListener('keydown', (e)=>{
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); enterDream(e); }
      });

      window.addEventListener('pageshow', () => { clicked = false; clearAll(); });
    });
  </script>
</body>
</html>
